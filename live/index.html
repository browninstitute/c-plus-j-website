<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="keywords" content="C+J, Computation, Journalism, 2022">
	<meta name="description" content="C+J 2022">
	<meta name="author" content="Brown Institute">
    <title>C+J 2022</title>
    <style>
        * {
        padding: 0;
        margin: 0;
        }

        html,
        body {
        width: 100%;
        height: 100%;
        }

        iframe {
        border: 0;
        width: 100%;
        height: 100%;
        }
    </style>
    <script>
        // Run this script once the window fully loads
        window.onload = () => {
        // Create an iframe
        const iframe = document.createElement('iframe');
        iframe.allow = 'camera; microphone;display-capture;clipboard-read;clipboard-write';

        // Read the wsid and invite code from URL
        // https://ohyay.co/app.html?wsid=ws_7WYZo2-u&invitecode=246d17d0-310a-43f8-a64e-0005994a80e5
        const searchParams = new URLSearchParams(window.location.search);
        const wsid = searchParams.get('wsid') ?? 'ws_RRsLBjUR';
        const inviteCode = searchParams.get('invitecode');

        let iframeSrc = 'https://ohyay.co/app.html?wsid=${encodeURIComponent(wsid)}';
        if (inviteCode) {
            iframeSrc = '${iframeSrc}&invitecode=${inviteCode}';
        }
		
	    const hash = window.location.hash;
        if (hash) {
        iframeSrc = '${iframeSrc}#${hash}'
        }
		
        iframe.src = iframeSrc;

        // Add the iframe to the page
        document.body.appendChild(iframe);

        // Remove the invite code from the URL.
        const searchString = searchParams.toString();
        history.replaceState(null, '', window.location.pathname +
            (window.location.hash ? `${window.location.hash}` : ''));
        };

        // Listen to messages from the iframe for when the scene changes
        window.addEventListener('message', (ev) => {
        const msg = ev.data;
        if (!msg) {
            return;
        }

        if (msg.type === 'hash-update') {
            const hash = msg.hash;
            if (hash) {
            history.pushState(null, null, '#' + hash);
            } else {
            history.pushState(null, null, ' ');
            }
        }
        });
    </script>

    
</head>

<body>
</body>

</html>
